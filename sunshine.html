<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸŒ é™½å…‰ï¼šç”¨é›»èˆ‡ç¢³æ’</title>
  <style>
    :root{
      --bg:#fdfdfd; --fg:#222; --nav:#f4f4f4; --link:#333;
      --card:#fff; --muted:#475569; --shadow:0 4px 12px rgba(0,0,0,.05);
      --accent:#1e90ff; --chip:#e2e8f0; --ok:#16a34a; --warn:#ef4444; --soft:#f9fafb;
    }
    body{font-family:"Microsoft JhengHei",sans-serif; margin:0; background:var(--bg); color:var(--fg); transition:background .3s,color .3s;}
    nav{background:var(--nav); padding:10px; display:flex; justify-content:space-between; align-items:center;}
    nav a{color:var(--link); text-decoration:none; margin-left:12px}
    nav .brand{font-weight:700; color:var(--accent)}
    main{max-width:1080px; margin:24px auto; padding:0 16px;}
    h1{margin:8px 0 16px; color:#2c3e50}
    p{line-height:1.75}

    /* æ·±è‰²æ¨¡å¼ï¼ˆèˆ‡å…¶ä»–é ä¸€è‡´ï¼‰ */
    body.dark{--bg:#0f172a; --fg:#e5e7eb; --nav:#1e293b; --link:#e5e7eb; --card:#0b1220; --muted:#94a3b8; --shadow:0 4px 16px rgba(0,0,0,.35); --chip:#0f2038; --soft:#111827}

    /* Switchï¼ˆ44x24ï¼Œèˆ‡å…¶ä»–é ä¸€è‡´ï¼‰ */
    .switch{margin-left:16px; position:relative; display:inline-block; width:44px; height:24px; vertical-align:middle;}
    .switch input{opacity:0; width:0; height:0;}
    .slider{position:absolute; cursor:pointer; inset:0; background:#ccc; transition:.4s; border-radius:24px;}
    .slider:before{position:absolute; content:""; height:18px; width:18px; left:3px; bottom:3px; background:white; transition:.4s; border-radius:50%;}
    .switch input:checked + .slider{background:var(--accent);}
    .switch input:checked + .slider:before{transform:translateX(20px);} 
    .switch-text{margin-left:8px; font-size:14px; color:#333; cursor:pointer; user-select:none; vertical-align:middle;}
    body.dark .switch-text{color:#e5e7eb;}

    /* Carousel */
    .carousel{position:relative; border-radius:12px; overflow:hidden; box-shadow:0 8px 20px rgba(0,0,0,.07);} 
    .carousel .stage{position:relative; width:100%; aspect-ratio:16/9; background:#111;}
    .carousel .slide{position:absolute; inset:0; display:none;}
    .carousel .slide.active{display:block;}
    .carousel img{width:100%; height:100%; object-fit:cover;}
    .caption{position:absolute; left:0; right:0; bottom:0; background:rgba(0,0,0,.55); color:#fff; padding:12px 14px; text-align:center;}
    .arrow{position:absolute; top:50%; transform:translateY(-50%); background:rgba(0,0,0,.45); color:#fff; border:none; width:42px; height:42px; border-radius:50%; cursor:pointer;}
    .prev{left:10px} .next{right:10px}
    .dots{position:absolute; left:0; right:0; bottom:10px; display:flex; gap:8px; justify-content:center;}
    .dot{width:10px; height:10px; border-radius:50%; border:2px solid rgba(255,255,255,.9); background:rgba(255,255,255,.25); cursor:pointer;}
    .dot.active{background:#fff}

    /* Sections */
    .section{margin-top:40px; padding:20px; border-radius:12px; box-shadow:var(--shadow);} 
    .cards{display:grid; gap:16px; margin-top:18px; grid-template-columns:repeat(auto-fit,minmax(220px,1fr));}
    .card{background:var(--card); padding:14px; border-radius:12px; display:flex; gap:12px; align-items:center; box-shadow:0 2px 8px rgba(0,0,0,.05); transition:transform .3s ease;}
    .card:hover{transform:scale(1.05);} 
    .card .i{font-size:28px;}
    .card .t{font-weight:700;}
    .muted{font-size:13px; color:var(--muted);} 

    /* Hero */
    .hero{margin-top:50px; position:relative; border-radius:12px; overflow:hidden; box-shadow:0 8px 24px rgba(0,0,0,.15);} 
    .hero img{width:100%; height:auto; display:block; animation:zoomIn 20s ease-in-out infinite alternate;}
    .hero-text{position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:rgba(0,0,0,0.45); color:#fff; padding:20px 30px; border-radius:12px; text-align:center; font-size:1.6em; font-weight:700; animation:floatText 4s ease-in-out infinite;}
    @keyframes zoomIn{from{transform:scale(1);} to{transform:scale(1.1);} }
    @keyframes floatText{0%,100%{transform:translate(-50%,-50%) translateY(0);} 50%{transform:translate(-50%,-50%) translateY(-10px);} }

    /* ===== ç¯€é›»å°éŠæˆ²ï¼šç”¨é›»æŒ‘æˆ° ===== */
    .game{margin-top:40px; border-radius:14px; padding:18px; background:var(--soft); box-shadow:var(--shadow);} 
    .game h2{margin:0 0 8px;}
    .status{display:flex; flex-wrap:wrap; gap:12px; align-items:center; margin:10px 0 14px;}
    .chip{padding:8px 12px; border-radius:999px; background:var(--chip); font-size:14px;}
    .power{font-weight:800;}
    .goal.ok{color:var(--ok);} .goal.bad{color:var(--warn);} 
    .appliances{display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:12px;}
    .appliance{background:var(--card); border-radius:12px; padding:12px; display:flex; gap:10px; align-items:center; justify-content:space-between; box-shadow:var(--shadow);} 
    .appliance .name{font-weight:700;}
    .appliance .w{font-size:12px; color:var(--muted);} 
    .appliance button{border:none; padding:8px 10px; border-radius:10px; cursor:pointer; background:#0ea5e9; color:#fff;}
    .appliance button.off{background:#475569;} 
    .bar{height:12px; background:#e5e7eb; border-radius:999px; overflow:hidden;}
    .bar>i{display:block; height:100%; width:0%; background:linear-gradient(90deg,#22c55e,#eab308,#ef4444);} 
    .tips{margin-top:12px; font-size:14px; color:var(--muted);} 
    .controls{margin-top:14px; display:flex; gap:12px;}
    .controls button{border:none; padding:10px 14px; border-radius:10px; cursor:pointer; background:#111827; color:#fff;}
    .msg{margin-top:10px; font-weight:800;}
  </style>
</head>
<body>
  <nav>
    <div class="brand">ğŸ“˜ UDM ESG æ°¸çºŒæ•™ç§‘æ›¸</div>
    <div>
      <a href="index.html">ğŸ  é¦–é </a>
      <a href="sunshine.html">ğŸŒ é™½å…‰</a>
      <a href="air.html">ğŸ’¨ ç©ºæ°£</a>
      <a href="water.html">ğŸ’§ æ°´</a>
      <a href="carbon.html">ğŸŒ± ç¢³åŒ¯</a>
      <!-- æ·±è‰²é–‹é—œï¼ˆå«æ–‡å­—ï¼Œçµ±ä¸€ä½ç½®èˆ‡å¤§å°ï¼‰ -->
      <label class="switch">
        <input type="checkbox" id="darkToggle" aria-label="åˆ‡æ›æ·±è‰²æ¨¡å¼">
        <span class="slider"></span>
      </label>
      <label class="switch-text" for="darkToggle">æ·±è‰²</label>
    </div>
  </nav>

  <main>
    <h1>ğŸŒ é™½å…‰ï¼šç”¨é›»èˆ‡ç¢³æ’</h1>
    <p>ä»‹ç´¹é›»åŠ›æ¶ˆè€—èˆ‡ç¢³æ’æ”¾çš„é—œè¯ã€‚é€éç”¨é›»æ•¸æ“šå­¸ç¿’å¦‚ä½•ç¯€èƒ½æ¸›ç¢³ï¼Œé™ä½æº«å®¤æ°£é«”æ’æ”¾ã€‚</p>

    <!-- è¼ªæ’­ s1~s6 -->
    <section class="carousel" id="sunCarousel">
      <div class="stage">
        <div class="slide active"><img src="s1.png" alt="ç”¨é›»è¶¨å‹¢"><div class="caption">ğŸ“ˆ ç”¨é›»è¶¨å‹¢ï¼šæŒæ¡æ¯æ—¥è€—é›»è®ŠåŒ–<br></br></div></div>
        <div class="slide"><img src="s2.png" alt="ç¸½ç¢³æ’æ”¾"><div class="caption">ğŸŒ ç¸½ç¢³æ’æ”¾ï¼šè§€å¯Ÿèƒ½æºä½¿ç”¨å¸¶ä¾†çš„æ’æ”¾<br></br></div></div>
        <div class="slide"><img src="s3.png" alt="ç›´æ–¹åœ–"><div class="caption">ğŸ“Š ç›´æ–¹åœ–ï¼šæ¯”å°ä¸åŒæ™‚é–“çš„ç”¨é›»åˆ†å¸ƒ<br></br></div></div>
        <div class="slide"><img src="s4.png" alt="åœ“é¤…åœ–"><div class="caption">ğŸ¥§ åœ“é¤…åœ–ï¼šå„è¨­å‚™ç”¨é›»æ¯”ä¾‹ä¸€ç›®äº†ç„¶<br></br></div></div>
        <div class="slide"><img src="s5.png" alt="æ¯æ—¥ç¢³æ’æ”¾"><div class="caption">ğŸ“… æ¯æ—¥è¿½è¹¤ï¼šäº†è§£æ—¥å¸¸ç¢³æ’æ”¾<br></br></div></div>
        <div class="slide"><img src="s6.png" alt="çµ±è¨ˆåˆ†æ"><div class="caption">ğŸ“ çµ±è¨ˆåˆ†æèˆ‡é æ¸¬ï¼šæŒæ¡æœªä¾†ç”¨é›»éœ€æ±‚<br></br></div></div>
        <button class="arrow prev">â€¹</button>
        <button class="arrow next">â€º</button>
        <div class="dots"></div>
      </div>
    </section>

    <!-- ç¯€ç´„ç”¨é›»çš„é‡è¦æ€§ -->
    <section class="section" style="background:#f9fafb;">
      <h2 style="color:#1e3a8a;">ğŸ’¡ ç¯€ç´„ç”¨é›»çš„é‡è¦æ€§</h2>
      <p style="line-height:1.8; color:#334155;">
        ç”¨é›»ä¸åªæ˜¯èŠ±éŒ¢ï¼Œæ›´èˆ‡ç¢³æ’æ”¾ç›´æ¥ç›¸é—œã€‚<br>
        æ¯ä¸€åº¦é›»èƒŒå¾Œéƒ½ä¼´éš¨ä¸€å®šé‡çš„ COâ‚‚ æ’æ”¾ã€‚<br>
        ç¯€é›» = æ¸›å°‘ç¢³æ’ï¼Œå°æŠ—æ°£å€™è®Šé·çš„é‡è¦è¡Œå‹•ã€‚
      </p>
      <div class="cards">
        <div class="card"><div class="i">ğŸ”Œ</div><div><div class="t">æ‹”æ‰æ’é ­</div><div class="muted">å¾…æ©Ÿè€—é›»é›–å°ï¼Œä½†ç´¯ç©é©šäºº</div></div></div>
        <div class="card"><div class="i">ğŸ’¡</div><div><div class="t">ç¯€èƒ½ç‡ˆå…·</div><div class="muted">LED æ¯”å‚³çµ±ç‡ˆæ³¡çœé›» 80%</div></div></div>
        <div class="card"><div class="i">ğŸŒ</div><div><div class="t">å–„ç”¨è‡ªç„¶å…‰</div><div class="muted">ç™½å¤©å°‘é–‹ç‡ˆï¼Œç¯€çœèƒ½æº</div></div></div>
        <div class="card"><div class="i">ğŸ </div><div><div class="t">æ™ºæ…§å®¶åº­</div><div class="muted">ç”¨æ™ºæ…§æ’åº§ç›£æ§ç”¨é›»</div></div></div>
      </div>
    </section>

    <!-- Hero s7 -->
    <section class="hero">
      <img src="s7.png" alt="ç”¨é›»è¨­å‚™">
      <div class="hero-text" id="heroText">ğŸ”‹ ç¯€èƒ½æ¸›ç¢³</div>
    </section>

    <!-- ===== ç¯€é›»å°éŠæˆ²ï¼šç”¨é›»æŒ‘æˆ° ===== -->
    <section class="game" id="game">
      <h2>ğŸ® ç¯€é›»å°éŠæˆ²ï¼šæŠŠå³æ™‚åŠŸç‡å£“åˆ° <span id="goal"></span> ä»¥å…§ï¼</h2>
      <div class="status">
        <span class="chip">ç›®å‰åŠŸç‡ï¼š<span class="power" id="powerNow">0 W</span></span>
        <span class="chip">æ¯å°æ™‚ COâ‚‚ï¼š<span id="co2Now">0 g</span></span>
        <span class="chip">ç›®æ¨™ç‹€æ…‹ï¼š<span id="goalState" class="goal">â€”</span></span>
      </div>
      <div class="bar" aria-hidden="true"><i id="barFill"></i></div>

      <div class="appliances" id="appliances"></div>
      <div class="tips" id="tips">æç¤ºï¼šé—œé–‰é«˜ç“¦æ•¸é›»å™¨æœ€æœ‰æ•ˆï¼Œä¾‹å¦‚å†·æ°£ã€é›»ç†±æ°´å™¨ã€çƒ¤ç®±ç­‰ã€‚</div>
      <div class="controls">
        <button id="reset">ğŸ” é‡æ–°æŠ½é¡Œ</button>
        <button id="allOff">ğŸ“´ å…¨éƒ¨é—œé–‰</button>
        <button id="allOn">ğŸŸ¢ å…¨éƒ¨é–‹å•Ÿ</button>
      </div>
      <div class="msg" id="msg"></div>
    </section>

  </main>

  <script>
    // æ·±è‰²é–‹é—œ + è¨˜æ†¶
    (function(){
      const KEY='udm_theme';
      const cb=document.getElementById('darkToggle');
      if(!cb) return;
      const saved=localStorage.getItem(KEY);
      if(saved==='dark'){ document.body.classList.add('dark'); cb.checked=true; }
      cb.addEventListener('change',()=>{
        const dark=cb.checked; document.body.classList.toggle('dark',dark); localStorage.setItem(KEY, dark ? 'dark' : 'light');
      });
    })();

    // è¼ªæ’­
    (function(){
      const root=document.getElementById('sunCarousel');
      const slides=root.querySelectorAll('.slide');
      const prevBtn=root.querySelector('.prev');
      const nextBtn=root.querySelector('.next');
      const dotsWrap=root.querySelector('.dots');
      let i=0, timer=null;

      slides.forEach((_,idx)=>{
        const d=document.createElement('div');
        d.className='dot'+(idx===0?' active':'');
        d.addEventListener('click',()=>go(idx));
        dotsWrap.appendChild(d);
      });
      const dots=dotsWrap.querySelectorAll('.dot');

      function go(n){
        slides[i].classList.remove('active'); dots[i].classList.remove('active');
        i=(n+slides.length)%slides.length; slides[i].classList.add('active'); dots[i].classList.add('active');
      }
      function next(){go(i+1);} function prev(){go(i-1);} 
      function play(){timer=setInterval(next,4000);} function stop(){clearInterval(timer); timer=null;}

      nextBtn.addEventListener('click',()=>{stop(); next(); play();});
      prevBtn.addEventListener('click',()=>{stop(); prev(); play();});
      root.addEventListener('mouseenter',stop);
      root.addEventListener('mouseleave',()=>!timer&&play());
      play();
    })();

    // Hero æ¨™èªè¼ªæ’­
    const heroTexts=["ğŸ”‹ ç¯€èƒ½æ¸›ç¢³","âš¡ è°æ˜ç”¨é›»","ğŸŒ æ¸›å°‘ç¢³æ’","ğŸ  æ°¸çºŒç”Ÿæ´»"]; let idx=0; const heroTextEl=document.getElementById("heroText");
    setInterval(()=>{ idx=(idx+1)%heroTexts.length; heroTextEl.textContent=heroTexts[idx]; },3000);

    // ===== å°éŠæˆ²é‚è¼¯ =====
    (function(){
      // æ’ç¢³ä¿‚æ•¸ï¼š0.495 kg/kWh â†’ æ¯å°æ™‚ g = (W/1000)*0.495*1000 = W*0.495
      const CO2_PER_WATT_PER_HOUR_G = 0.495; 

      const APPLIANCE_BANK=[
        {name:'å†·æ°£(è®Šé »)', base:900, tips:'æé«˜1â„ƒå¯çœ 3~5% ç”¨é›»'},
        {name:'é›»ç†±æ°´å™¨', base:2000, tips:'æ´—æ¾¡æ”¹ç”¨ç¯€æµè“®è“¬é ­çœæ°´åˆçœé›»'},
        {name:'é›»å†°ç®±', base:120, tips:'é–€å°æ¢è¦ç·Šå¯†ã€ç†±èœæ”¾æ¶¼å†é€²å†°ç®±'},
        {name:'é›»è¦–', base:90, tips:'é™ä½äº®åº¦æˆ–ä½¿ç”¨ç¯€èƒ½æ¨¡å¼'},
        {name:'é›»è…¦æ¡Œæ©Ÿ', base:180, tips:'è¢å¹• 10 åˆ†é˜è‡ªå‹•ä¼‘çœ '},
        {name:'ç­†é›»', base:40, tips:'çœé›»æ¨¡å¼+é—œé–‰é«˜è€—èƒ½æ‡‰ç”¨'},
        {name:'çƒ¤ç®±/æ°£ç‚¸é‹', base:1200, tips:'ä¸€æ¬¡å¤šçƒ¤ã€å–„ç”¨é ç†±é¤˜æº«'},
        {name:'æ´—è¡£æ©Ÿ(è„«æ°´)', base:400, tips:'æ»¿æ¡¶æ´—æ›´çœé›»çœæ°´'},
        {name:'å¹é¢¨æ©Ÿ', base:1000, tips:'å…ˆä»¥æ¯›å·¾å£“ä¹¾å†å¹'},
        {name:'ç…§æ˜(LED)', base:10, tips:'ç™½å¤©æ”¹ç”¨è‡ªç„¶å…‰'},
        {name:'è·¯ç”±å™¨', base:8, tips:'æ•£ç†±è‰¯å¥½å¯é™è€—æ'},
        {name:'é™¤æ¿•æ©Ÿ', base:250, tips:'æ¿•åº¦è¨­å®š 55~60%'}
      ];

      const $ = (q)=>document.querySelector(q);
      const $$ = (q)=>document.querySelectorAll(q);
      const listEl = $('#appliances');
      const powerNowEl = $('#powerNow');
      const co2NowEl = $('#co2Now');
      const barFillEl = $('#barFill');
      const goalEl = $('#goal');
      const goalStateEl = $('#goalState');
      const tipsEl = $('#tips');
      const msgEl = $('#msg');

      const resetBtn = $('#reset');
      const allOffBtn = $('#allOff');
      const allOnBtn = $('#allOn');

      let appliances = [];
      let goalW = 0;

      function randomPick(n){
        const arr=[...APPLIANCE_BANK];
        for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; }
        return arr.slice(0,n);
      }

      function newRound(){
        // äº‚æ•¸æŠ½ 6~8 å€‹é›»å™¨
        const count=6+Math.floor(Math.random()*3);
        appliances = randomPick(count).map(x=>({ ...x, on: Math.random() < 0.6 }));
        // ç›®æ¨™ï¼šéš¨æ©Ÿè¨­å®šç‚ºç•¶å‰ç¸½åŠŸç‡çš„ 50%~70%
        const currentW=sumW(appliances);
        goalW = Math.floor(currentW * (0.5 + Math.random()*0.2));
        render();
        showMsg('è©¦è‘—æŠŠè£ç½®é—œåˆ°ã€ç¶ è‰²ã€å€åŸŸï¼Œé”æˆç›®æ¨™ï¼');
      }

      function sumW(items){ return Math.round(items.reduce((s,a)=>s + (a.on ? a.base : 0), 0)); }

      function render(){
        // Header info
        goalEl.textContent = `${goalW} W`;

        // List
        listEl.innerHTML='';
        appliances.forEach((a,idx)=>{
          const card=document.createElement('div'); card.className='appliance';
          const left=document.createElement('div');
          left.innerHTML=`<div class="name">${a.name}</div><div class="w">${a.base} W</div>`;
          const btn=document.createElement('button'); btn.textContent=a.on?'ON':'OFF'; btn.className=a.on?'':'off';
          btn.addEventListener('click',()=>{ a.on=!a.on; btn.textContent=a.on?'ON':'OFF'; btn.className=a.on?'':'off'; update(); });
          card.appendChild(left); card.appendChild(btn); listEl.appendChild(card);
        });
        update();
      }

      function update(){
        const w = sumW(appliances);
        powerNowEl.textContent = `${w} W`;
        const co2g = Math.round(w * CO2_PER_WATT_PER_HOUR_G);
        co2NowEl.textContent = `${co2g} g / å°æ™‚`;

        // é€²åº¦æ¢ï¼š0~120% çš„è¦–è¦ºåŒ–
        const pct = Math.max(0, Math.min(1.2, w / goalW));
        barFillEl.style.width = `${Math.min(100, pct*100)}%`;

        // ç›®æ¨™ç‹€æ…‹
        const ok = w <= goalW;
        goalStateEl.textContent = ok ? 'âœ… é”æ¨™' : 'â³ æœªé”';
        goalStateEl.className = 'goal ' + (ok? 'ok':'bad');

        // æç¤ºï¼šæ‰¾å‡ºè€—é›»å‰ä¸‰åä¸”ç‚º ON
        const hot = appliances.filter(a=>a.on).sort((a,b)=>b.base-a.base).slice(0,3);
        if(hot.length){
          tipsEl.textContent = 'å»ºè­°å…ˆé—œï¼š' + hot.map(a=>`${a.name}(${a.base}W)`).join('ã€') + 'ã€‚';
        }else{
          tipsEl.textContent = 'åšå¾—å¥½ï¼ç›®å‰æ²’æœ‰é«˜è€—é›»è£ç½®ã€‚';
        }

        if(ok){ showMsg('ğŸ‰ å¤ªæ£’äº†ï¼ä½ å·²ç¶“æŠŠå³æ™‚åŠŸç‡å£“åˆ°ç›®æ¨™ä»¥ä¸‹ã€‚'); }
        else{ clearMsg(); }
      }

      function showMsg(t){ msgEl.textContent=t; }
      function clearMsg(){ msgEl.textContent=''; }

      // Controls
      resetBtn.addEventListener('click', newRound);
      allOffBtn.addEventListener('click',()=>{ appliances.forEach(a=>a.on=false); update(); });
      allOnBtn.addEventListener('click',()=>{ appliances.forEach(a=>a.on=true); update(); });

      // å•Ÿå‹•
      newRound();
    })();
  </script>
</body>
</html>